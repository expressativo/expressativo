<div class="bg-white shadow-md rounded-2xl px-6 pt-6 pb-8 mb-4 max-w-4xl mx-auto">
  <div class="flex justify-between items-center mb-6">
    <h1 class="text-2xl font-semibold">
      Miembros de <%= @project.title %>
    </h1>
    <%= link_to "Volver al proyecto", project_path(@project), class: "button-outline" %>
  </div>

  <div class="mb-6 space-y-4">
    <!--  
    <%= link_to "Invitar nuevo miembro", new_project_member_path(@project), class: "button mb-4" %>
    -->
    
    <!-- Link de invitaci칩n -->
    <div class="bg-gray-50 border border-gray-200 rounded-lg p-4 mt-4" data-controller="clipboard">
      <h3 class="font-semibold mb-3 text-gray-700">Link de invitaci칩n</h3>
      <p class="text-sm text-gray-600 mb-3">
        Comparte este link para que cualquier persona pueda unirse al proyecto:
      </p>
      
      <div class="flex gap-2 items-center">
        <input 
          type="text" 
          readonly 
          value="<%= project_invitation_url(token: @project.invitation_token) %>"
          data-clipboard-target="source"
          class="input flex-1 bg-white text-sm"
        />
        <button 
          data-clipboard-target="button"
          data-action="click->clipboard#copy"
          class="button whitespace-nowrap">
          Copiar link
        </button>
        <% if @project.owner == current_user %>
          <%= button_to "Regenerar", 
              regenerate_invitation_project_path(@project), 
              method: :post,
              form: {
                data: { turbo_confirm: "쮼st치s seguro? El link anterior dejar치 de funcionar." }
              },
              class: "button-outline whitespace-nowrap" %>
        <% end %>
      </div>
      
      <p class="text-xs text-gray-500 mt-2">
        游눠 Cualquier persona con este link podr치 unirse al proyecto
      </p>
    </div>
  </div>

  <div class="space-y-4">
    <% if @owner %>
      <div class="border border-gray-300 rounded-lg p-4 bg-blue-50">
        <div class="flex justify-between items-center">
          <div>
            <div class="flex items-center gap-2">
              <h3 class="font-semibold text-lg"><%= @owner.email %></h3>
              <span class="inline-block bg-blue-600 text-white text-xs px-2 py-1 rounded">Propietario</span>
            </div>
            <% if @owner.first_name.present? || @owner.last_name.present? %>
              <p class="text-gray-600 text-sm"><%= [@owner.first_name, @owner.last_name].compact.join(' ') %></p>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>

    <% if @members.any? %>
      <h2 class="text-lg font-semibold mt-6 mb-3">Miembros</h2>
      <% @members.each do |project_user| %>
        <div class="border border-gray-300 rounded-lg p-4">
          <div class="flex justify-between items-center">
            <div>
              <h3 class="font-semibold"><%= project_user.user.email %></h3>
              <% if project_user.user.first_name.present? || project_user.user.last_name.present? %>
                <p class="text-gray-600 text-sm"><%= [project_user.user.first_name, project_user.user.last_name].compact.join(' ') %></p>
              <% end %>
            </div>
            <div>
              <%= button_to project_member_path(@project, project_user),
                method: :delete,
                form: {
                  data: { turbo_confirm: "쮼st치s seguro de eliminar este miembro?" }
                },
                class: "icon-button text-red-600 hover:bg-red-50"  do %>
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-trash"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7l16 0" /><path d="M10 11l0 6" /><path d="M14 11l0 6" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    <% else %>
      <div class="text-center py-8 text-gray-500">
        <p>No hay miembros adicionales en este proyecto.</p>
        <p class="text-sm mt-2">Invita a personas para colaborar en este proyecto.</p>
      </div>
    <% end %>
  </div>
</div>
